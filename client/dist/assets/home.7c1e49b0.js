import{n,i as m,a as _,r as h,B as v,f as c,C as g,d as w,D as b,E as y,L as A}from"./index.4d4590a9.js";import{U as C}from"./uploadApp.488a428b.js";var $=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"collectionView-wrapper"},[e("ul",{staticClass:"collectionView-wrapper-ul"},t._l(this.dataArr,function(r,i){return e("li",{key:i,staticClass:"itemWrapper"},[e("div",{staticClass:"appItem-platform"},[e("i",{class:t.getPlatformClass(r)})]),e("img",{staticClass:"appItem-icon",attrs:{src:t.getIcon(r)},on:{error:function(o){return t.setIcon(o,r)},click:function(o){return t.gotoAppDetail(r)}}}),e("div",{staticClass:"appItem-info"},[e("div",{staticClass:"appItem-info-namewrapper"},[e("p",{staticClass:"nowrap",on:{click:function(o){return t.gotoAppDetail(r)}}},[t._v(t._s(r.appName))])]),e("table",{staticStyle:{width:"100%","table-layout":"fixed","margin-top":"24px"}},[e("tr",[e("td",{staticClass:"appItem-info-title"},[t._v("\u77ED\u94FE\u63A5:")]),e("td",[e("div",{staticClass:"appItem-info-appInfo nowrap",domProps:{innerHTML:t._s(t.getShortUrl(r))}})])]),e("tr",[e("td",{staticClass:"appItem-info-title"},[t._v("BundleId:")]),e("td",[e("div",{staticClass:"appItem-info-appInfo nowrap"},[t._v(t._s(r.bundleId||"-"))])])])])]),e("button",{staticClass:"preview button-style-border",on:{click:function(o){return t.clickPreviewBtn(r)}}},[e("i",{staticClass:"icon-ic_overview"}),e("span",[t._v("\u9884\u89C8")])]),e("button",{staticClass:"editor button-style-border",on:{click:function(o){return t.clickEditorBtn(r)}}},[e("i",{staticClass:"icon-ic_edit"}),e("span",[t._v("\u7F16\u8F91")])])])}),0)])},x=[];const L={props:{minimumLineSpacing:{type:Number},minimumInteritemSpacing:{type:Number},dataArr:{type:Array}},data(){return{}},computed:{},created(){},methods:{getPlatformClass(s){return s.platform=="android"?"icon-ic_andr":s.platform=="ios"?"icon-ic_ios":"icon-ic_rn"},gotoAppDetail(s){this.$emit("gotoAppDetail",s)},getIcon(s){return console.log("icon",s.icon),s.icon||""},setIcon(s,t){t.platform=="ios"?s.target.src=m:t.platform=="android"?s.target.src=_:t.platform=="rn"&&(s.target.src=h)},getShortUrl(s){return window.location.origin+"/"+s.shortUrl},clickEditorBtn(s){this.$emit("gotoAppDetail",s)},clickPreviewBtn(s){const{href:t}=this.$router.resolve({name:"AppPreView",path:"/",params:{id:s.shortUrl}});window.open(t,"_blank")}}},p={};var k=n(L,$,x,!1,P,null,null,null);function P(s){for(let t in p)this[t]=p[t]}var I=function(){return k.exports}(),E="/assets/empty-arrow.b0a328a5.png",V="/assets/empty_app.4f191eca.png",D=function(){var t=this,a=t.$createElement;return t._self._c,t._m(0)},U=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"empty-app-wrapper"},[a("img",{staticClass:"arrow",attrs:{src:E,alt:""}}),a("div",{staticClass:"empty-wrapper"},[a("img",{staticClass:"empty",attrs:{src:V,alt:""}}),a("p",[s._v("\u7A7A\u7A7A\u5982\u4E5F\uFF5E\uFF5E")]),a("p",[s._v("\u70B9\u51FB\u5DE6\u4E0A\u89D2\u6309\u94AE\uFF0C\u521B\u5EFA\u7B2C\u4E00\u4E2A\u5E94\u7528\u5427")])])])}];const q={data(){return{}},created(){},methods:{}},d={};var S=n(q,D,U,!1,N,null,null,null);function N(s){for(let t in d)this[t]=d[t]}var T=function(){return S.exports}(),F=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"app-list-wrapper"},[e("div",{staticClass:"app-list-header"},[e("div",{staticClass:"app-list-header-left",staticStyle:{position:"relative"}},[e("el-button",{staticClass:"uploadWrapper",on:{click:t.addNewApp}},[e("i",{staticClass:"icon-ic_add"}),t._v("\u65B0\u5EFA\u5E94\u7528")]),e("div",{staticStyle:{width:"120px",height:"16px","background-color":"#229FFC",position:"absolute",top:"30px",left:"12px","border-radius":"10px",filter:"blur(10px)","z-index":"-1"}})],1),e("div",{staticClass:"app-list-header-right"},[e("div",{staticClass:"platform-wrapper"},[e("div",{staticClass:"platform-ios",class:t.getActiveClass("ios"),on:{click:t.clickIosPlatform}},[e("span",{staticClass:"platformImg icon-ic_ios"})]),e("div",{staticClass:"platform-android",class:t.getActiveClass("android"),on:{click:t.clickAndroidPlatform}},[e("span",{staticClass:"platformImg icon-ic_andr"})]),e("div",{staticClass:"platform-rn",class:t.getActiveClass("rn"),on:{click:t.clickRnPlatform}},[e("span",{staticClass:"platformImg icon-ic_rn"})])]),e("div",{staticClass:"search-wrapper"},[e("i",{staticClass:"el-icon-search"}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.queryText,expression:"queryText"}],staticClass:"app-list-header-search",attrs:{type:"text",placeholder:"\u8F93\u5165\u540D\u79F0\u641C\u7D22"},domProps:{value:t.queryText},on:{input:function(i){i.target.composing||(t.queryText=i.target.value)}}})])])]),e("collectionView",{attrs:{dataArr:this.dataList},on:{gotoAppDetail:t.gotoAppDetail}}),this.showEmpty?e("emptyView"):t._e(),e("el-dialog",{attrs:{title:"\u6DFB\u52A0\u9879\u76EE",visible:t.addAppVisible,center:"",width:"30%"},on:{"update:visible":function(i){t.addAppVisible=i},close:t.closeAddAppDialog}},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.rules}},[e("el-form-item",{attrs:{required:"",label:"\u540D\u79F0",size:"mini",prop:"name"}},[e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0"},model:{value:t.form.name,callback:function(i){t.$set(t.form,"name",i)},expression:"form.name"}})],1),e("el-form-item",{attrs:{required:"",size:"mini",label:"\u5E73\u53F0"}},[e("el-radio-group",{model:{value:t.form.platform,callback:function(i){t.$set(t.form,"platform",i)},expression:"form.platform"}},[e("el-radio",{attrs:{label:"android"}},[t._v("Android")]),e("el-radio",{attrs:{label:"ios"}},[t._v("iOS")]),e("el-radio",{attrs:{label:"rn"}},[t._v("ReactNaive")])],1)],1),e("el-form-item",{attrs:{label:"\u63CF\u8FF0"}},[e("el-input",{attrs:{type:"textarea",clearable:!0,rows:"5",placeholder:"",maxlength:"500","show-word-limit":""},model:{value:t.form.describe,callback:function(i){t.$set(t.form,"describe",i)},expression:"form.describe"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeAddAppDialog}},[t._v("\u53D6 \u6D88")]),e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(i){return t.submitForm("form")}}},[t._v("\u786E \u5B9A")])],1)],1)],1)},M=[];const B={name:"Apps",data(){return{currentPlatform:"",dataList:[],originDataList:[],queryText:"",showUploadView:!1,file:FileList,currentPage:0,currentTeam:{},showEmpty:!1,addAppVisible:!1,loading:!1,form:{name:"",platform:"android",describe:""},rules:{name:[{required:!0,trigger:"blur",validator:(s,t,a)=>{t==null||t.length<1?a(new Error("\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0")):a()}}],platform:[{required:!0,trigger:"blur",validator:(s,t,a)=>{t==null||t.length<1?a(new Error("\u8BF7\u9009\u62E9\u5E73\u53F0")):a()}}]}}},components:{UploadApp:C,CollectionView:I,EmptyView:T},computed:{},methods:{loadAppList(){v().then(s=>{this.dataList=[],this.dataList=s.data.reverse(),this.originDataList=this.dataList,c.setApps(this.dataList),this.dataList.length===0?this.showEmpty=!0:this.showEmpty=!1,console.log(this.dataList)},s=>{this.$message.error(s),this.showEmpty=!0})},submitForm(s){this.loading=!0,this.$refs[s].validate(t=>{if(t){const a={appName:this.form.name,platform:this.form.platform,describe:this.form.describe};g(a).then(e=>{this.loading=!1,this.$message({message:"\u6210\u529F",type:"success"}),this.loadAppList(),this.closeAddAppDialog()}).catch(e=>{this.loading=!1,this.$message.error(e)})}else console.log("error submit!!")})},addNewApp(){this.addAppVisible=!0},closeAddAppDialog(){this.addAppVisible=!1},referenceUpload(s){this.file=s.target.files,s.target.files.length>0&&(this.showUploadView=!0)},closeUploadMethod(){this.showUploadView=!1,this.$refs.referenceUpload.value=""},uploadSuccessMethod(){this.showUploadView=!1,this.$refs.referenceUpload.value="",this.loadAppList()},clickIosPlatform(){this.currentPlatform==="ios"?this.currentPlatform="":this.currentPlatform="ios"},clickAndroidPlatform(){this.currentPlatform==="android"?this.currentPlatform="":this.currentPlatform="android"},clickRnPlatform(){this.currentPlatform==="rn"?this.currentPlatform="":this.currentPlatform="rn"},getActiveClass(s){if(s===this.currentPlatform)return"platformActive"},gotoAppDetail(s){c.setCurApp(s),this.$router.push("/distribute")},appItemHovered(){},appItemUnhovered(){},clickEditorBtn(){},clickPreview(){},deleteApp(s){this.$confirm("\u786E\u8BA4\u5220\u9664\uFF1F").then(t=>{w(s._id).then(a=>{this.loadAppList()},a=>{this.$message.error(a)})}).catch(t=>{})}},destroyed(){this.bus.$off("refreshList")},mounted(){this.bus.$on("refreshList",()=>{this.loadAppList()}),this.$watch("queryText",()=>{let s=[];this.dataList.forEach(t=>{t.appName.search(this.queryText)!==-1&&s.push(t)}),this.dataList=s,this.queryText.length===0&&(this.dataList=this.originDataList)}),this.loadAppList()},created(){this.$nextTick(()=>{})},watch:{currentPlatform(s){if(this.dataList=this.originDataList,s===""){this.dataList.length===0?this.showEmpty=!0:this.showEmpty=!1;return}let t=[];this.dataList.forEach(a=>{a.platform===s&&t.push(a)}),this.dataList=t,this.dataList.length===0?this.showEmpty=!0:this.showEmpty=!1}}},u={};var R=n(B,F,M,!1,j,null,null,null);function j(s){for(let t in u)this[t]=u[t]}var z=function(){return R.exports}(),H=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"app-wrapper"},[e("div",{staticClass:"header-wrapper"},[e("logo",{staticClass:"logo"}),e("headerNav",{staticClass:"nav-header",attrs:{showSwitchApp:!1}})],1),e("div",{staticClass:"main-container"},[e("appList")],1)])},W=[];const O={name:"Layout",components:{AppMain:b,HeaderNav:y,Logo:A,appList:z},data(){return{showUserInfo:!1,showUserMessage:!1}},created(){},destroyed(){}},f={};var G=n(O,H,W,!1,J,"34f591f0",null,null);function J(s){for(let t in f)this[t]=f[t]}var X=function(){return G.exports}();export{X as default};
