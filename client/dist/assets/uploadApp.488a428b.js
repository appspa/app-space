import{n as l,k as n,l as c}from"./index.4d4590a9.js";var r="/assets/loadding.accf0f87.gif",d=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"uploadApp-wrapper"},[o("div",{staticClass:"uploadContent"},[o("img",{attrs:{src:r}}),o("div",{staticStyle:{"font-size":"20px","margin-top":"30px",color:"#229FFC"},domProps:{innerHTML:t._s("\u6B63\u5728\u4E0A\u4F20\u4E2D...".concat(t.progress,"%"))}})])])},u=[];const _={props:{appFile:{type:FileList},appInfo:{type:Object}},data(){return{progress:0,source:null}},created(){this.$nextTick(()=>{this.beginLoad()})},methods:{cancelUpload(){this.source&&this.source.cancel("\u53D6\u6D88\u4E0A\u4F20"),this.$emit("closeUpload")},beginLoad(){const s=this;let t=n.CancelToken;s.source=t.source();let a=new FormData;a.append("appId",this.appInfo._id),a.append("active",this.appInfo.autoPublish),a.append("platform",this.appInfo.platform),a.append("file",this.appFile[0]);let o={onUploadProgress:function(e){let i=Math.round(e.loaded*100/e.total);s.$nextTick(()=>{s.progress=i})},cancelToken:s.source.token};n.defaults.headers.common["Content-Type"]="multipart/form-data",n.post("api/apps/upload",a,o).then(e=>{console.log(e),c.exports.Message({message:e.data.success?"\u4E0A\u4F20\u6210\u529F":e.data.message,type:e.data.success?"success":"error"}),e.data.success?this.$emit("uploadSuccess",e.data):this.$emit("closeUpload")}).catch(function(e){if(this.$emit("closeUpload"),n.isCancel(e)){console.log("Request canceled",e.message);return}c.exports.Message.error("\u4E0A\u4F20\u5931\u8D25")})}}},p={};var m=l(_,d,u,!1,f,null,null,null);function f(s){for(let t in p)this[t]=p[t]}var g=function(){return m.exports}();export{g as U};
