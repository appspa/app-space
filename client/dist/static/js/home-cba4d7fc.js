import{n as t,i as e,a,r as i,B as s,f as r,C as o,d as l,D as n,E as p,L as c}from"./index-8ea49c21.js";import{U as d}from"./uploadApp-309740c5.js";import"./vueRouter-5522c294.js";const m={};var h=t({props:{minimumLineSpacing:{type:Number},minimumInteritemSpacing:{type:Number},dataArr:{type:Array}},data:()=>({}),computed:{},created(){},methods:{getPlatformClass:t=>"android"==t.platform?"icon-ic_andr":"ios"==t.platform?"icon-ic_ios":"icon-ic_rn",gotoAppDetail(t){this.$emit("gotoAppDetail",t)},getIcon:t=>(console.log("icon",t.icon),t.icon||""),setIcon(t,s){"ios"==s.platform?t.target.src=e:"android"==s.platform?t.target.src=a:"rn"==s.platform&&(t.target.src=i)},getShortUrl:t=>window.location.origin+"/"+t.shortUrl,clickEditorBtn(t){this.$emit("gotoAppDetail",t)},clickPreviewBtn(t){const{href:e}=this.$router.resolve({name:"AppPreView",path:"/",params:{id:t.shortUrl}});window.open(e,"_blank")}}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"collectionView-wrapper"},[a("ul",{staticClass:"collectionView-wrapper-ul"},t._l(this.dataArr,(function(e,i){return a("li",{key:i,staticClass:"itemWrapper"},[a("div",{staticClass:"appItem-platform"},[a("i",{class:t.getPlatformClass(e)})]),a("img",{staticClass:"appItem-icon",attrs:{src:t.getIcon(e)},on:{error:function(a){return t.setIcon(a,e)},click:function(a){return t.gotoAppDetail(e)}}}),a("div",{staticClass:"appItem-info"},[a("div",{staticClass:"appItem-info-namewrapper"},[a("p",{staticClass:"nowrap",on:{click:function(a){return t.gotoAppDetail(e)}}},[t._v(t._s(e.appName))])]),a("table",{staticStyle:{width:"100%","table-layout":"fixed","margin-top":"24px"}},[a("tr",[a("td",{staticClass:"appItem-info-title"},[t._v("短链接:")]),a("td",[a("div",{staticClass:"appItem-info-appInfo nowrap",domProps:{innerHTML:t._s(t.getShortUrl(e))}})])]),a("tr",[a("td",{staticClass:"appItem-info-title"},[t._v("BundleId:")]),a("td",[a("div",{staticClass:"appItem-info-appInfo nowrap"},[t._v(t._s(e.bundleId||"-"))])])])])]),a("button",{staticClass:"preview button-style-border",on:{click:function(a){return t.clickPreviewBtn(e)}}},[a("i",{staticClass:"icon-ic_overview"}),a("span",[t._v("预览")])]),a("button",{staticClass:"editor button-style-border",on:{click:function(a){return t.clickEditorBtn(e)}}},[a("i",{staticClass:"icon-ic_edit"}),a("span",[t._v("编辑")])])])})),0)])}),[],!1,u,null,null,null);function u(t){for(let e in m)this[e]=m[e]}var f=function(){return h.exports}();const g={};var v=t({data:()=>({}),created(){},methods:{}},(function(){var t=this;t.$createElement;return t._self._c,t._m(0)}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"empty-app-wrapper"},[a("img",{staticClass:"arrow",attrs:{src:"data:image/png;base64,",alt:""}}),a("div",{staticClass:"empty-wrapper"},[a("img",{staticClass:"empty",attrs:{src:"data:image/png;base64,",alt:""}}),a("p",[t._v("空空如也～～")]),a("p",[t._v("点击左上角按钮，创建第一个应用吧")])])])}],!1,w,null,null,null);function w(t){for(let e in g)this[e]=g[e]}const b={};var C=t({name:"Apps",data:()=>({currentPlatform:"",dataList:[],originDataList:[],queryText:"",showUploadView:!1,file:FileList,currentPage:0,currentTeam:{},showEmpty:!1,addAppVisible:!1,loading:!1,form:{name:"",platform:"android",describe:""},rules:{name:[{required:!0,trigger:"blur",validator:(t,e,a)=>{null==e||e.length<1?a(new Error("请输入项目名称")):a()}}],platform:[{required:!0,trigger:"blur",validator:(t,e,a)=>{null==e||e.length<1?a(new Error("请选择平台")):a()}}]}}),components:{UploadApp:d,CollectionView:f,EmptyView:function(){return v.exports}()},computed:{},methods:{loadAppList(){s().then((t=>{this.dataList=[],this.dataList=t.data.reverse(),this.originDataList=this.dataList,r.setApps(this.dataList),0===this.dataList.length?this.showEmpty=!0:this.showEmpty=!1,console.log(this.dataList)}),(t=>{this.$message.error(t),this.showEmpty=!0}))},submitForm(t){this.loading=!0,this.$refs[t].validate((t=>{if(t){const t={appName:this.form.name,platform:this.form.platform,describe:this.form.describe};o(t).then((t=>{this.loading=!1,this.$message({message:"成功",type:"success"}),this.loadAppList(),this.closeAddAppDialog()})).catch((t=>{this.loading=!1,this.$message.error(t)}))}else console.log("error submit!!")}))},addNewApp(){this.addAppVisible=!0},closeAddAppDialog(){this.addAppVisible=!1},referenceUpload(t){this.file=t.target.files,t.target.files.length>0&&(this.showUploadView=!0)},closeUploadMethod(){this.showUploadView=!1,this.$refs.referenceUpload.value=""},uploadSuccessMethod(){this.showUploadView=!1,this.$refs.referenceUpload.value="",this.loadAppList()},clickIosPlatform(){"ios"===this.currentPlatform?this.currentPlatform="":this.currentPlatform="ios"},clickAndroidPlatform(){"android"===this.currentPlatform?this.currentPlatform="":this.currentPlatform="android"},clickRnPlatform(){"rn"===this.currentPlatform?this.currentPlatform="":this.currentPlatform="rn"},getActiveClass(t){if(t===this.currentPlatform)return"platformActive"},gotoAppDetail(t){r.setCurApp(t),this.$router.push("/distribute")},appItemHovered(){},appItemUnhovered(){},clickEditorBtn(){},clickPreview(){},deleteApp(t){this.$confirm("确认删除？").then((e=>{l(t._id).then((t=>{this.loadAppList()}),(t=>{this.$message.error(t)}))})).catch((t=>{}))}},destroyed(){this.bus.$off("refreshList")},mounted(){this.bus.$on("refreshList",(()=>{this.loadAppList()})),this.$watch("queryText",(()=>{let t=[];this.dataList.forEach((e=>{-1!==e.appName.search(this.queryText)&&t.push(e)})),this.dataList=t,0===this.queryText.length&&(this.dataList=this.originDataList)})),this.loadAppList()},created(){this.$nextTick((()=>{}))},watch:{currentPlatform(t){if(this.dataList=this.originDataList,""===t)return void(0===this.dataList.length?this.showEmpty=!0:this.showEmpty=!1);let e=[];this.dataList.forEach((a=>{a.platform===t&&e.push(a)})),this.dataList=e,0===this.dataList.length?this.showEmpty=!0:this.showEmpty=!1}}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-list-wrapper"},[a("div",{staticClass:"app-list-header"},[a("div",{staticClass:"app-list-header-left",staticStyle:{position:"relative"}},[a("el-button",{staticClass:"uploadWrapper",on:{click:t.addNewApp}},[a("i",{staticClass:"icon-ic_add"}),t._v("新建应用")]),a("div",{staticStyle:{width:"120px",height:"16px","background-color":"#229FFC",position:"absolute",top:"30px",left:"12px","border-radius":"10px",filter:"blur(10px)","z-index":"-1"}})],1),a("div",{staticClass:"app-list-header-right"},[a("div",{staticClass:"platform-wrapper"},[a("div",{staticClass:"platform-ios",class:t.getActiveClass("ios"),on:{click:t.clickIosPlatform}},[a("span",{staticClass:"platformImg icon-ic_ios"})]),a("div",{staticClass:"platform-android",class:t.getActiveClass("android"),on:{click:t.clickAndroidPlatform}},[a("span",{staticClass:"platformImg icon-ic_andr"})]),a("div",{staticClass:"platform-rn",class:t.getActiveClass("rn"),on:{click:t.clickRnPlatform}},[a("span",{staticClass:"platformImg icon-ic_rn"})])]),a("div",{staticClass:"search-wrapper"},[a("i",{staticClass:"el-icon-search"}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.queryText,expression:"queryText"}],staticClass:"app-list-header-search",attrs:{type:"text",placeholder:"输入名称搜索"},domProps:{value:t.queryText},on:{input:function(e){e.target.composing||(t.queryText=e.target.value)}}})])])]),a("collectionView",{attrs:{dataArr:this.dataList},on:{gotoAppDetail:t.gotoAppDetail}}),this.showEmpty?a("emptyView"):t._e(),a("el-dialog",{attrs:{title:"添加项目",visible:t.addAppVisible,center:"",width:"30%"},on:{"update:visible":function(e){t.addAppVisible=e},close:t.closeAddAppDialog}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",rules:t.rules}},[a("el-form-item",{attrs:{required:"",label:"名称",size:"mini",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("el-form-item",{attrs:{required:"",size:"mini",label:"平台"}},[a("el-radio-group",{model:{value:t.form.platform,callback:function(e){t.$set(t.form,"platform",e)},expression:"form.platform"}},[a("el-radio",{attrs:{label:"android"}},[t._v("Android")]),a("el-radio",{attrs:{label:"ios"}},[t._v("iOS")]),a("el-radio",{attrs:{label:"rn"}},[t._v("ReactNaive")])],1)],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",clearable:!0,rows:"5",placeholder:"",maxlength:"500","show-word-limit":""},model:{value:t.form.describe,callback:function(e){t.$set(t.form,"describe",e)},expression:"form.describe"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeAddAppDialog}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.submitForm("form")}}},[t._v("确 定")])],1)],1)],1)}),[],!1,A,null,null,null);function A(t){for(let e in b)this[e]=b[e]}const y={};var _=t({name:"Layout",components:{AppMain:n,HeaderNav:p,Logo:c,appList:function(){return C.exports}()},data:()=>({showUserInfo:!1,showUserMessage:!1}),created(){},destroyed(){}},(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-wrapper"},[e("div",{staticClass:"header-wrapper"},[e("logo",{staticClass:"logo"}),e("headerNav",{staticClass:"nav-header",attrs:{showSwitchApp:!1}})],1),e("div",{staticClass:"main-container"},[e("appList")],1)])}),[],!1,L,"34f591f0",null,null);function L(t){for(let e in y)this[e]=y[e]}var x=function(){return _.exports}();export{x as default};
